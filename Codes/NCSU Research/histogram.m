clear all
set1=[1.28980579859646	2.37201428294264	3.64258134857737	3.00345492564338	1.85451600676826	1.79568492940863	2.55775609457229	2.42042273769657	0.903624488740052	1.80316017888852	4.72154501817967	0.824570434394891	0.495644775540252	3.79377760409714	9.58850816973932	1.54696583670172	0.660859700720336	0.650206238634582	1.17095204376576	2.52533840009102	1.80642973496991	1.17634431318445	2.19340818766162	0.551325953976705	6.35766431931022	0.262183798840967	2.73393523280985	3.30978737154787	1.63856249808537	3.45199583796226	4.65318075121864	2.63417768068723	3.25039477597360	2.18858962837414	0.893654466124782	3.84799536050950	1.63158532400247	2490.61499709543	1.48538243452499	3.49682695274100	2.90366073691608	3.92068476519445	2.72272751799920	3320.81999612976	1.62440241127655	4.16142856656604	905.678180760664	3.84057825302972	1.44992868408661	4.22317083016494	3.42823812400519	1.10240787743267	2.39885865358996	4.78504322207450	3.38628823533620	2.89354051360996	1.77520669785443	2.58563716282354	2.49123780654141	2.47084821139858	4.14239500555472	1.59731601544959	4.84084547539315	2.63069975927095	4.92703263519244	2.28969432046865	0.919555103226793	11.6248074543281	0.916256781785990	2.57827639450287	3.41297019128438	4.96138445635414	4.18590755813408	6.19170912887453	1.30432835668487	10.4428301764771	1.28052184940348	3.79811665587461	1.10473053763130	6.15346509472459	4.97376934016930	1.15133017316065	2.71161131964047	2.55251344820884	4.63801675435713	0.598094494108126	0.832981604377848	1.06493425850979	13.2479521121798	4.02849170576591	4.97128741934087	1.43324125857561	7.04060776562482	1.26716611401158	5.87063051759524	1.31205847337799	3.27389417954620	4.44752678051746	2.94138175032745	1.04713684973293	1.51612539771101	0.822663913159295	1.22328830898319	1.73380786431589	7.00102599322497	0.704359444878328	1.60762626889770	2.22277108174009	3.20748872773957	3.52778328199685	1.86423278225282	1.29618266827466	3.23666666288469	2.96678379641426	1.12991493573314	3.28468842346162	0.589878618530349	2.54274119151585	1.26958837624048	0.576131158244221	0.681426811789266	1.11449378994956	1.29399402368607	3.99457096566123	1.14274604133506	5.01634440501466	1.28398762577124	1.89508464682501	2.90112405019193	6.78179713298783	5.61581735533208	2.52022767223857	1.20174426880085	2.92583259570017	4.97874062386762	1.34682438669178	1.84285238408418	1.72063212234181	1.30143174243750	2.36245197732015	3.02534466697816	13.5175847874616	4.01712096304802	1.61126637366312	2.91983000831157	5.92650802400899	0.891894358850409	3.72289237233150	0.903214867484956	0.894135701701586	0.211028829002077	2.23825207556933	0.995250748087819	2.28235051279704	3.19002881471633	3.56566212897605	2.70866231331133	10.6550374207050	1.30843971478317	3.14968700232662	3.25145560977777	7.28249999149059	3.66806332413811	10.8405440569741	3.65058995542656	1.15053239269651	2.32387683423352	0.823820390999675	2.14108316964519	1.53056690557061	2.00049397356608	1.25947661041202	0.937202256665952	2.34080356869339	4.38102901862757	3.52778328199685	4.86923753096730	2.68819751439803	0.712265674437625	0.479033513889458	0.677349740845735	2.73243554261083	1.90087006074396	9.54258619574631	0.968451442437938	5.37349513935227	2.34355680742392	3.33304114699200	1.36322659939232	6.26175989211761	8.98328222575216	7.86303077218558	0.688300399914264	7.20872647493424	3.55548179456071	3.14570886907455	2.34135369879179	2.22376339025872	2.52661932243446	3.85992250614456	2.78514397214400	1.62202214072925	2.06134077971427	0.906337335185505	2.19582543274390	2.94747336933701	2.37654102775742	6.41911081724170	4.95398308719995	2.83507683220236	2.66661134592053	2.23624242162942	3.57846982340485	3.24298827746064	2.09075760511208	1.44362555982598	0.820023046206195	1.73290311156011	2.52341944993898	0.922535418868328	1.90851723914925	1.26619979516511	4.45947179425206	2.00089575986324	2.24278703024743	1.85313615854894	1.09309413960490	1.44028624958206	1.72241701043553	4.39649602310640	3.48337761830738	0.934827811612937	4.20534402210177	1.25899911390864	2.77042825037794	1.89148661256106	2.30772758590667	6.07837705208000	3.39667916411834	1.55882647290863	2.28549208267013	1.54744641012101	2.90281468192281	1.42036783409739	2.24937005833350	0.977574329149158	4.06797059549167	0.273228566407741	3.04755582390917	1.81366466199874	0.923048270949603	3.87644357523700	4.04978048307280	1.45098455991248	2.49186092755355	1.89436394530502	3.70351672429706	2.20897117258516	4.69263306093222	2.55907012287672	3.26423983891189	2.10134148668194	5.72555171744777	0.307711267246079	1.12672019773344	1.49205631097186	2.92669212348974	4.55739249238751	4.01226741375719	1.51936251156917	6.68621475728800	1.23603721939939	0.493093446266039	1.93935370612402	1.32939151165720	3.05409564327379	2.81823479161502	0.357538759272145	0.347075668490770	1.51889922066764	1.12227779524153	1.07354094702145	75.4731817299981	11.7343462760414	2.61139187112951	1.52915732745343	2.02612568402666	2.25242143078433	5.33322269184107	0.992375733475353	0.986284525132073	1.61387655732368	1.88219535015286	1.00326888100293	5.22963778916489	2.40059276827930	2.34080356869339	3.59396103476158	0.340108561667317	1.87193911844402	1.27658380168620	5.16993253158231	3.53278722991457	2.89270034505200	0.916762674920316	2.95709705798726	0.652890752235341	6.95217026403289	3.40829968811464	1.12291027821901	7.55304017313050	2.03647996491396	4.72378377826416]';
set2=[8.86339856615582	6.82360273175282	12.4220199356099	1.52821905021615	1.30092191020620	2.36245197732015	4.28308683936333	2.47514533872275	3.02810333992678	5.59688763390961	16.8284797100662	3.03271232522347	3.80246564441187	2.10089835266957	3.41648147748940	2.46901114953137	2.04232472086082	1.93108354106592	1.50809264128960	8.16595081013044	3.47851256576784	1.68683711282748	1.66679939574353	1.70560862666651	4.22317083016494	1.85832120655831	3.05596932158254	1.71382418516413	7.76497271111390	2.44838043459304	1.21404581871302	2.26831966948067	1.08252308903174	5.29636363017497	142.320856976577	3.93617542013398	10.9237499872359	6.90877946488150	0.411808035233096	3.67618449754948	0.861655421930381	4.40232434306633	1.07493094393171	2.26471015875405	2.98455961304946	0.841495057721013	1660.40999806236	1.93935370612402	8.15926288972902	1.19210960731830	2.73844419691014	1.19153928816638	3.55167914023497	1.56249372464854	2.81584510694152	1.34773538803559	2.87102593324469	1.29248313289557	1.03959720216624	1.00804006762714	0.887919785058741	1.80872548808262	1.65187530896353	1.61649521148127	3.04011595616695	1.08523529284957	4.98372185510711	16.9429591638762	4.03501822128761	2.13100748414098	2.22674563888223	2.76427857612627	1.27953506143836	0.960978102475072	1.13830667143042	2.80632675728425	3.07673254736229	1.91328211798715	9.91289551080513	2.94138175032745	1.55809508732547	2.27661334286085	13.3366264904407	1.31326917853402	1.08986544014430	1.61623296371822	1.85382582589488	2.53950037939309	2.96678379641426	1.86562921130320	1.03549111197995	1.73652779995801	6.95217026403289	1.15386379295333	3.07483332974046	0.657327790205797	0.988241244753404	2.55644341502671	0.970054526617242	3.75516773025220	1.38041568357476	2.08463276592573	10.7238535934975	0.810483240185410	1.92288361095524	1.14039148218396	1.28167502744874	3.47487268516188	3.11326874636222	3.62007993763049	1.96536989314640	0.838167591145807	1.06618792683637	2.98187967325923	2.17568464476066	1.03916344929165	2.01424585288295	2.13649152656210	1.89292418551379	5.86717313802068	18.1796715116044	1.98179032989041	3.32081999611970	2.09163552138549	1.39628030670765	2.10622832734864	0.982878846523192	1.90268525369730	1.29905593797876	0.845925107273420	1.93333203732953	4.00259541517039	1.11874901609872	1.79892740851554	1.54528617781279	1.68484018067970	2.22674563888223	1.44698039046610	0.650163805283499	2.56632148077256	3.10841185284215	1.73986377721954	6.61078964058336	2.17378572733124	2.23123403994604	2.27038741758411	1.17759574330485	0.778377997371597	3.08626393691422	1.90596135227838	1.11424449036563	3.04848836853093	4.43169928307789	7.62238713722964	0.452263482311561	0.775590501234649	4.43169928307789	0.863298092578775	4.28677280049875	1.77173394777860	-207.551249757441	3.60045536261622	2.60184382041240	1.04823863513879	4.97625374043912	5.37059837647391	1.72869338684003	5.33036917515201	0.546727032617663	17.3864921262814	4.10315485517261	4.08800163658560	2.59709593022917	1.48516100005353	0.605657486069613	0.428529765500648	1.94351540935604	2.44537554942540	2.45622780778084]';
set3=[3.32303535302171	1.68740853461367	2.04148770253260	3.36228821746848	3.18086206524875	1.70414984405732	1.70153031398105	3.94709191297904	3.00164507031006	1.41673208025584	2.79687254024680	1.49766385874310	1.88897610700779	2.28969432046865	2.32876577568001	0.723858169611208	3.79956521295160	1.33616684393228	2.43521388129041	3.77508904447105	2.59304008026004	0.824570434394891	0.961256270586556	0.346062942488504	1.61885927662643	1.08134809381950	0.730867873843377]';
%set4=[28.7
% 26.4
% 20.6
% 16.6
% 15.7
% 13.5
% 11];
settot=[set1;set2;set3];
dest=1;

er1=[0.0371908069526142	0.0800756293636286	0.0421419802617751	0.00931803202666189	0.0196527204443816	0.0442598923338422	0.0632482169166134	0.000249475842491649	0.0265527854751021	0.156482899426347	0.0893870545685986	0.0187396915290129	0.0387519031936346	0.0786884398215559	0.0189355000116481	0.0117419756263827	0.0468187084804325	0.107221666888818	0.286630092599737	0.0817851129835548	0.0418454426824931	0.0330654157786783	0.114559984475756	0.0525705508057554	0.0846740540457539	0.0212092767566287	0.235486375457225	0.0194478820058627	0.0133800098985722	0.0786837852838605	0.0165335486502873	1.56091349506456e-05	0.0268401738009692	0.0212004241723582	0.0308091332007947	0.0317800648352921	0.0352423772556655	0.0197754256522619	0.0743484057176200	8.63400292554786e-05	0.0274082111292204	0.0312035407791874	0.0457950692816092	0.0337396197829721	0.0904452131037592	0.000163083166391072	0.0458075654393327	0.0442980817440889	0.000114072067922213	0.0442716297158229	0.100213496640511	0.0183674120304112	0.0642346523551332	0.128742793840674	0.0691964890206574	0.0202741479608014	0.0152742422501156	0.0366154513864470	0.0417955085146080	0.0509090896283355	0.0357019417326450	0.0150677440086448	0.0467632269850549	0.0284984138056273	0.0262125054281562	1.53927517911204e-06	0.0196190978361689	0.0140318936183226	0.0459523967787327	0.0613705056194261	0.00800670580040011	0.117054145252448	0.0347627352109974	0.0261890961539421	0.0128591562923721	0.00887111665073355	0.0212788050066004	0.0650955722496585	0.0177220388579111	0.126526688205038	0.0258807222844367	0.0204784024171524	0.0225905438138361	0.00918931201522973	0.0796194571439549	0.0621798102306357	0.0243120275585937	0.0201808420254180	0.128820384924466	0.0760474975962107	0.204331181189873	0.0235285870559252	0.0455562100469440	0.0230554134788841	0.172936833793516	0.0558165383655507	0.101698886731606	0.0178760305694665	0.0361772768136922	0.0286544395732230	0.0421314598178946	0.0690688574871877	0.0218583396494643	0.0971272132064631	0.199881293507428	0.133982524545386	0.104522007533239	0.0384114326764121	0.187603019949383	0.0244199222506146	0.0512429684304542	0.0622877488891295	0.0276552460711876	0.218638611048140	0.0817636194798698	0.0588931197697897	0.0505415807051228	0.0731587809776068	0.0179532431222392	0.105553106329346	0.0467337495618448	0.0901944030668477	0.239201242119716	0.137505324094980	0.0789954281093946	0.130835373614018	0.0315952177014914	0.104547993923941	0.0156198343475144	0.108498791901566	0.0874865586603890	0.0266982609440360	0.0305428031316933	0.0358066193159312	0.0437444061658375	0.173024774344842	0.0475626814939752	0.0391147188874121	0.207853797252694	0.109838611673917	0.0412402636151773	0.0474298265742580	0.163043810677122	0.0358638856270612	0.0193411680706957	0.0396335888452807	0.0547646808827305	0.0358023197515697	0.0206712013272572	0.208844308314607	0.0171441668314177	0.217515442559996	0.0624141376227551	0.734512811398552	0.0366550099206366	0.0984814656541553	0.0781262737906105	0.484809274676333	0.0287891495532829	0.0787142922183971	0.0125553419451450	0.158541464647291	0.0198651696322590	0.0218186409610092	0.0287679125760299	0.0189704846570734	0.0160070552856938	0.0243052243991124	0.0847021214484214	0.0431165421204666	0.0724583979292918	0.0382409853885187	0.0337819515902731	0.0435798742784878	0.0828857853792535	0.0833092601071213	0.0265595973961152	0.0835619528721500	0.0372967579419077	0.0476240906141091	0.0329844515660522	0.194021916911287	0.263648806249382	0.0763614652398660	0.0210701282939693	0.0661682647703707	0.0141381141937377	0.0726018277407373	0.0221016789501355	0.0552144589139353	0.0515893522142735	0.0496824694604091	0.0191105558691198	0.00875235000118563	0.00964398940115586	0.0653299635253052	0.0307946960412701	0.0370476513113896	0.0435189072380906	0.0335864611901865	0.0911901346421313	0.0298121231347705	0.0557363748483440	0.0533818928516711	0.0511667994440677	0.0313528212768692	0.0873617702767875	0.0306341039695306	0.154006563913293	0.0290119728438036	0.0239145280178446	0.0405752030137167	0.0511723427089365	0.0592832479290409	0.0304216495728273	0.0722966072753861	0.0360771494506912	0.0401078997853676	0.0793953735070408	0.267445689398627	0.183757278069125	0.0381687097834504	0.0591225954106002	0.0795029771891379	0.0720554197598424	0.0298986021063176	0.0755744696646300	0.0418537416770774	0.0449699346244127	0.113838414122067	0.0487882740777879	0.0608580479727276	0.0319842735830431	0.0719127960436387	0.315542529287404	0.0423223113649467	0.0387118703589725	0.0325356248282720	0.0462830592234432	0.0828809869629601	0.0255491450969155	0.0301281934981651	0.135603794696538	0.0458810549219174	0.0684289438486187	0.0309373362966511	0.0380126010448669	0.125306642396873	0.0827356779771971	0.0924800639193673	0.718234942904550	0.0462265078985933	0.0453222105988698	0.144967048389760	0.362808790837405	0.0377308030231304	0.0840488834681559	0.0402861524852078	0.0638351603630157	0.0180760925099305	0.0922226141472338	0.0207330010557942	0.0684593925476823	0.0428554590447999	0.0284313944068125	0.0157971120920268	0.280489352621280	0.106748657738364	0.0852217391923117	0.0178486231723060	0.0264871412496336	0.0476614862521248	0.129622281821934	0.0437789537962854	0.107095354534775	0.365761766097803	0.138109340651589	0.0718697169907958	0.0354144436178369	0.0696145886610706	0.160063498374313	0.130005138932185	0.112836877836058	0.223118812037916	0.179544160656082	0.00215545196859651	0.0216675637638633	0.0386712065535174	0.0746591194067652	0.0359109507936088	0.0688902141193213	0.0370206644599462	0.245775750497844	0.0998009817334263	0.157631075427953	0.0584372977069852	0.0777781336810080	0.0379837312841453	0.0647283741231504	0.0670906603051334	0.0604775146061596	0.279184621278569	0.0523409246979799	0.0881587792495922	0.0284839769907959	0.0348478715625652	0.0688513381810470	0.121299662794048	0.0436612620166857	0.124312766160845	0.0251938729944902	0.0457787053894515	0.152499825556328	0.0236336334546068	0.0541413960917277	0.0164582524730930];
er2=[0.00727481902798303	0.0247987772972171	0.0264653506792104	0.116649453730000	0.0395428811393741	0.0702366451068224	0.0430712157135097	0.0240249121515959	0.0257920060043386	0.0653559655470271	0.0141463715887340	0.0185273647431648	0.0204968101955754	0.0409426879536057	0.0123659790099538	0.0136800256559495	0.0790688745348976	0.0255463802345195	0.0338525433322470	0.0324985385675306	0.0261784424621270	0.0284470120605007	0.106214443448897	0.0310943013067087	0.0357348992467532	0.103867134095633	0.0650753555403690	0.103159906718991	0.0113049029797594	0.0817489516698129	0.0356378452570522	0.0701729228300747	0.0304393090753179	0.0159891464383192	0.000699589534007222	0.0186782880074511	0.00194261518286359	0.00873000478127565	0.392558731410616	0.0354327171485652	0.0542595626308853	0.0174747062960566	0.0656777045809584	0.0622603846893622	0.0742597649653290	0.238964969749122	0.000107030297086250	0.0608601876451246	0.0371692055769745	0.0960699491799162	0.0307835443020500	0.0318869960473563	0.0580993417559118	0.0661879436847727	0.0289229226445501	0.109645838804293	0.0407386511787229	0.0453873527261154	0.115006345065484	0.217343588798958	0.225010373832693	0.0216840870264462	0.0595161204754577	0.0260927681928074	0.0260466690277276	0.0462519145357741	0.00962231001057244	0.00690714287300849	0.0192606808464051	0.0326513040264730	0.0369604623560138	0.0452990191293479	0.149234656342561	0.0809329268334665	0.0423222277665594	0.0326814200978763	0.0607568875134599	0.0793864565485481	0.0168508486395190	0.0358748474743244	0.0388310005500123	0.0509137999384234	0.0221459640263939	0.0358554005376795	0.0502135752464043	0.103736719603591	0.0980291623040342	0.0645727875773110	0.0345001655519555	0.0410918893263362	0.186035315906894	0.0544921589901585	0.00930095592684489	0.114200997428686	0.0173919153784537	0.185055964633335	0.106682733735626	0.0238687808798923	0.143164036640225	0.0191960967448512	0.128363896178414	0.0778506782890244	0.0151062932658828	0.270449517058386	0.105508843911082	0.285798487210704	0.0520101606366573	0.0367287875559227	0.0727709601007767	0.0935633541711372	0.0490538845441420	0.102980915398951	0.120472926548284	0.0472752842307848	0.0414747473325516	0.169340402432877	0.0327393001219909	0.0899177297018762	0.0527658595014446	0.0224630186072974	0.00611238550699389	0.0688318591224449	0.0365796585769985	0.0701701619900302	0.131353409938268	0.0692759904551352	0.0785562578693622	0.0534419943857602	0.0892970306496040	0.0833817847161389	0.0979529614045492	0.0577730358720862	0.124782910256985	0.0515451049778905	0.0758670893797198	0.0585237820506108	0.139063214694503	0.0597763072659196	0.170154804477143	0.0343819780254831	0.0269492281670161	0.0649200901464319	0.0143896810755219	0.0473631975922785	0.0927978401917799	0.110144124316022	0.0662644870242400	0.0868062680320808	0.0781990268085766	0.0551663480213025	0.199950577791437	0.0360764282417821	0.0917233553713051	0.0186557813305338	0.113861860577710	0.234445153789411	0.0458462078858485	0.182021910984343	0.0213172538409425	0.0839537247958885	0.000565296530079327	0.109829512986208	0.0568552761350955	0.170465653902201	0.0682096782904467	0.0361738397036043	0.109734670112606	0.0425273023752592	0.378883992359134	0.00957540187395310	0.0367582754191905	0.0331344680195566	0.0396683861494034	0.0942880134282123	0.159736964797502	0.209051082938946	0.0419775058760998	0.0813464266549193	0.0604697650388426];
er3=[0.0138128109897345	0.0381960398856998	0.0361770454045754	0.0172319869699852	0.0563998437580091	0.0233146206895360	0.0778126417455405	0.0266600468423252	0.0352802980606810	0.141519651832848	0.0645863926636777	0.0761010181870756	0.0941033837393310	0.0992509263616927	0.0932523797082480	0.0481319782237691	0.0526563339223498	0.289532937602132	0.0412983785345770	0.0339370647889716	0.0293536222738674	0.0932824894444008	0.0684204378352943	0.264778026618901	0.0924612967616539	0.0960315885353698	0.215681492183213];
% er4=[0.198455899756474,0.042478619560503,0.040089457375296,0.067574683775469,0.039360912386038,0.045761112807552,0.026650146523652];

% 
% figure()
% edges = [-10 0:2:40 40];
% hold on
% histogram(set1,edges)
% 
% histogram(set2,edges)
% 
% histogram(set3,edges)
% 
% histogram(set4,edges)
% 
% hold off

% figure()
% bar([set1 set2 set3 set4],'stacked')
% figure()
% histogram(settot)
% h1.Binwidth=5;
% h1.Normalization='probability';



%% 
binrng = 0:0.5:10;
counts1=histc(set1,binrng);
counts2=histc(set2,binrng);
counts3=histc(set3,binrng);
% counts4=histc(set4,binrng);


counts5=counts1+counts2+counts3;
figure()
bar(binrng,counts5)
hold on

bar(binrng,counts2)
bar(binrng,counts3)
xline(dest,'LineWidth',2.5)
xline(mean(settot),'b','LineWidth',2.5)
xline(median(settot),'r','LineWidth',2.5)

legend('Video 1','Video 2','Video 3','Expected Radius','Mean','Median')
    title('Radius of Beads in Control data')
    xlabel('Radius (um)')
    ylabel('Counts')
    h = gca;
    set(h,'FontSize',[24]);
    set(gca, 'box', 'off')
hold off
